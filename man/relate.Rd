% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/methods-relate.R
\name{relate}
\alias{relate}
\alias{relate,giottoSpatial,giottoSpatial-method}
\alias{relate,giotto,giottoSpatial-method}
\title{Spatial relationships between geometries}
\usage{
\S4method{relate}{giottoSpatial,giottoSpatial}(
  x,
  y,
  relation,
  pairs = TRUE,
  na.rm = TRUE,
  output = c("data.table", "matrix"),
  use_names = TRUE,
  ...
)

\S4method{relate}{giotto,giottoSpatial}(
  x,
  y,
  ...,
  what = c("polygon", "spatlocs", "points"),
  spat_unit = NULL,
  feat_type = NULL,
  spat_locs_name = NULL
)
}
\arguments{
\item{x}{spatial object with records to test}

\item{y}{spatial object records to test relations against}

\item{relation}{character. One of "intersects", "touches", "crosses", "overlaps", "within", "contains", "covers", "coveredby", "disjoint". Or a "DE-9IM" string such as "FF*FF****". See \href{https://en.wikipedia.org/wiki/DE-9IM}{wikipedia} or \href{https://docs.geotools.org/stable/userguide/library/jts/dim9.html}{geotools doc}}

\item{pairs}{logical. If \code{TRUE} a two-column matrix is returned with the indices of the cases where the requested relation is \code{TRUE}. This is especially helpful when dealing with many geometries as the returned value is generally much smaller}

\item{na.rm}{logical. If \code{TRUE} and \code{pairs=TRUE}, geometries in \code{x} for which there is no related geometry in \code{y} are omitted}

\item{output}{character. \code{"data.table"} or \code{"matrix"}. \code{"data.table"} is
only possible when \code{pairs=TRUE}}

\item{use_names}{logical. If \code{TRUE}, \code{pairs=TRUE}, and \code{output="data.table"}
the IDs of the geometries will be used.}

\item{...}{additional args to pass}

\item{what}{character. Which type of spatial data in the \code{giotto} object to
relate. One of "polygon", "spatlocs", "points"}

\item{spat_unit}{spatial unit}

\item{feat_type}{feature type}

\item{spat_locs_name}{name of spatlocs to use if what = "spatlocs"}
}
\value{
\code{data.table} if \code{output="data.table"}. \code{matrix} if \code{output="matrix"}
}
\description{
\code{relate()} returns a logical matrix indicating the presence or
absence of a specific spatial relationships between the geometries in
x and y.
}
\examples{
g <- GiottoData::loadGiottoMini("viz")
activeSpatUnit(g) <- "aggregate"
sl <- g[["spatial_locs"]][[1]]
gpoints <- g[["spatial_info]][[1]]
gpoly <- g[["feat_info]][[1]]

relate(gpoints, gpoly, relation = "intersects")
relate(gpoints, gpoly, relation = "intersects", use_names = FALSE)

selection <- system.file("extdata/viz_interactive_select.csv",
    package = "GiottoClass"
)
select_polys <- createGiottoPolygon(data.table::fread(selection))
res <- relate(g, select_polys, relation = "intersects")
g[,res[y == "polygon1", x]]
g[,res[y == "polygon2", x]]
g[,res[y == "polygon3", x]]
}
